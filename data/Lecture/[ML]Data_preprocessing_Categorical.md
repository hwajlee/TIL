# 범주형 변수(Categorical Feature)
성별, 혈액형 등과 같이 유한한 선택 범위의 값을 취하는 변수 
> 이때 범주형 변수는 일반적으로 문자열(string) 형식으로 입력되는 데, 의사결정 나무 등 소수의 모델이 이러한 문자열 형식 입력을 직접적으로 처리할 수 있지만, 로지스틱 회귀, SVM 등과 같은 모델에서는 반드시 수치형 변수로 전환해여 분석 작업 가능 

<br>

## 범주형 변수 데이터 정제 작업
<br>

**" Categorical endoing is a process of converting categories to numbers."**

* 일반적으로 원-핫 인코딩과 레이블 인코딩이 많이 활용되며, 
  > 설명변수(독립변수)가 범주형 변수일 때 원-핫 인코딩

  > 대상변수(종속변수)가 0과 1의 이진변수이거나 범주형일 때 레이블 인코딩
  * 참고) DL에서는 종속변수 또한 원-핫 인코딩 처리 가능 

<br>

1. 순서형 인코딩(Oridinary encoding)
   - 대소 관계가 존재하는 데이터에서 많이 사용 
   - 예로 성적의 경우 '높음 > 중간 > 낮음'과 같은 순서형 관계를 지니므로, 이러한 대소 관계에 따라 하나의 수치 ID 부여하는 것 
    ```
    좋음 =  3, 중간 = 2, 낮음 = 1 -> 변환 후에도 여전히 대소 관계 유지됨을 확인 가능 
    ```
2. **원-핫 인코딩(One-hot encoding)**
   - 대소 관계가 존재하지 않는 데이터에서 많이 사용 
   - 변수 벡터의 특정 값이 1이 되고, 기타 위치의 값들은 모두 0이 되도록 만드는 것 
   - 예로 혈액형은 A형, B형, AB형, O형 네 가지 값을 가질 수 있으므로, 4차원의 희소 벡터(spare vector)로 만드는 것 
   - 여러 범주형 변수를 한 번에 인코딩 가능(레이블 인코딩과의 차이점)
   - 변수의 클래스(범주) 수 만큼 차원이 확대되기 때문에 너무 많은 범주를 가진 변수를 원-핫 인코딩 할 때 주의 필요 
    ```
    A형: (1, 0, 0, 0), B형: (0, 1, 0, 0), AB형: (0, 0, 1, 0), O형: (0, 0, 0, 1)
    ```
3. 이진 인코딩(Bibary encoding)
    - 단계1. 순번 인덱스를 사용하여 각 클래스에 ID 부여 
    - 단계2. 각 클래스 ID를 이진법 코드로 나타내는 것 
    - 사실상 이진법을 이용하여 ID에 대해 해시 매핑(hash mapping)을 진행한 것
    - 차원의 수 원-핫 인코딩보다 작아 저장 공간 절약 가능

<br>

#### **이진 인코딩 VS 원-핫 인코딩**

| 혈액형   | 클래스 ID  | 이진법 표현   | 원-핫 인코딩   |
| ------ | ----------- | ------------------ | ------------------ |
| A | 1 |  0 0 1  |  1 0 0 0  |
| B | 2 |  0 1 0  |  0 1 0 0  |
| AB | 3 |  0 1 1   |  0 0 1 0  |
| O | 4 |  1 0 0  |  0 0 0 1  |

4. **레이블 인코딩(Label encoding)**
   - n개의 범주형 데이터를 0부터 n-1까지 연속적 수치 데이터로 표현하는 것
   - 이때 인코딩의 결과가 **수치적인 차이를 의미하는 것은 아님** 주의
   - 그럼에도 불구하고 컴퓨터는 이것을 순서로 이해하고 처리할 확률이 높으므로, 이러한 레이블 인코딩의 단점을 해결하기 위해 원-핫 인코딩 사용
   - 레이블 인코딩은 **한 번 실행시킬 때 단 하나의 컬럼만** 실행 가능 
    ```
    A형 = 0, B형 = 1, AB형 = 2, O형 = 3 
    ```


--- 
#### 참고자료
@ https://ecogis.net/298

@ https://majored-computerscience.tistory.com/entry/%EB%B2%94%EC%A3%BC%ED%98%95-%EB%B3%80%EC%88%98%EC%9D%98-%EC%9D%B8%EC%BD%94%EB%94%A9-Categorical-Encoding

@ 데이터 과학자와 데이터 엔지니어를 위한 인터뷰 문답지 Chapter1.