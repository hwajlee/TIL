## 반정규화
---
- 데이터베이스의 성능 향상을 위하여, **데이터 중복을 허용하고 조인을 줄이는** 데이터베이스 성능 향상 방법
- 정규화된 엔터티, 속성, 관계에 대해 시스템의 성능향상과 개발과 운영의 단순화를 위해 **중복, 통합, 분리** 등을 수행하는 데이터 모델링 기법을 의미 
- 반정규화는 조회(Select) 속도를 향상시키지만, 데이터 모델의 유연성은 낮아짐 
- 반정규화 수행 이유 
  - 정규화에 충실하여 종속성, 활용성은 향상되었지만 수행속도가 느려진 경우 
  - **다량의 범위**를 자주 처리해야 하는 경우 
  - 특정 범위의 데이터만 자주 처리하는 경우
  - 요약/집계 정보가 자주 요구되는 경우 
  - 디스크 I/O량이 많아 성능이 저하되거나 or 경로가 너무 멀어 조인으로 인한 성능저하가 예상되거나 or 칼럼을 계산하여 읽을 때 성능이 저하될 것이 예상되는 경우 
  
<br>

### 반정규화 절차 

|반정규화 절차      |설명                                                  |
|------------------|------------------------------------------------------|
|대상 조사 및 검토  |데이터 처리 범위, 통계성 등을 확인해서 반정규화 대상 조사 |
|다른 방법 검토     |반정규화를 수행하기 전에 다른 방법이 있는지 검토한다.     |
|                  |예를 들어 클러스터링, 뷰, 인덱스 튜닝, 응용 프로그램, 파티션 등을 검토한다. |
|반정규화 수행      |테이블, 속성, 관계 등을 반정규화한다.                     |


<br>

- 반정규화 대상에 대해 다른 방법으로 처리 
  - [Clustering]
    - 클러스터링 인덱스라는 것은 인덱스 정보를 저장할 때, 물리적으로 정렬해서 저장하는 방법 
    - 따라서 조회 시 인접 블록을 연속적으로 읽기 때문에 성능이 향상된다.
    - 대량의 데이터처리나 부분처리에 의해 성능이 저하되는 경우 클러스터링을 적용하거나 인덱스를 조정함으로써 성능을 향상시킬 수 있음

  - [Partitioning]
    - 하나의 테이블에 많은 양의 데이터가 저장되면 인덱스를 추가하고 테이블을 몇 개로 쪼개도 성능이 저하되는 경우가 있음. 이때 논리적으로는 하나의 테이블이지만, 물리적으로는 여러 개의 테이블로 분리하여 데이터 엑세스 성능도 향상시키고, 데이터 관리방법도 개선할 수 있도록 테이블에 적용하는 기법  
    - 대량의 데이터는 Primary Key의 성격에 따라 부분적인 테이블로 분리할 수 있음. 즉, 파티셔닝 기법이 적용되어 성능 저하 방지 가능
  
  - [뷰(VIEW)]: 지나치게 많은 조인(JOIN)이 걸려 데이터를 조회하는 경우 뷰를 사용하면 이를 해결할 수 있음 
  - [응용 애플리케이션]: 응용 애플리케이션 로직을 구사하는 방법을 변경함으로써 성능을 향상시킬 수 있음 
  

<br>

### 테이블의 반정규화 

|기법분류     |반정규화 기법             |
|------------|-------------------------|
|테이블 병합  |1:1 관계 테이블 병합     |
|            |1:M 관계 테이블 병합     |
|            |슈퍼/서브 타입 테이블 병합|
|테이블 분할  |수직 분할                |
|            |수평 분할                |
|테이블 추가  |중복 테이블 추가         |
|            |통계 테이블 추가         |
|            |이력 테이블 추가         |
|            |부분 테이블 추가         |

<br>

- [Super type과 Sub type]
  - 슈퍼타입과 서브타입의 관계는 배타적 관계와 포괄적 관계가 있는데, 배타적 관계는 고객이 개인이거나 법인고객인 경우를 의미
  - 포괄적인 관계는 고객이 개인고객일 수도 있고 법인고객일 수도 있는 것 

<br>

- 슈퍼 타입 및 서브 타입 변환 방법 

|변환 방법      |설명                                             |
|--------------|-------------------------------------------------|
|OneToOne Type |슈퍼 타입과 서브 타입을 개별 테이블로 도출한다.     |
|              |테이블의 수가 많아서 조인이 많이 발생하고 관리하기 어렵다. |
|Plus Type     |슈퍼 타입과 서브 타입 테이블로 도출한다.            |
|              |조인이 발생하고 관리가 어렵다.                     |
|Single Type   |슈퍼 타입과 서브 타입을 하나의 테이블로 도출한다.   |
|              |조인 성능이 좋고 관리가 편하지만, 입출력 성능이 나쁘다. | 

<br>

### 칼럼의 반정규화 

|반정규화 기법            |
|------------------------|
|중복칼럼 추가            |
|파생칼럼 추가            |
|이력테이블 칼럼 추가     |
|PK에 의한 칼럼 추가      |
|응용시스템 오작동을 위한 칼럼 추가  |


<br>

---
#### 참고자료
@ https://sodayeong.tistory.com/106