테이블명: CAR_RENTAL_COMPANY_RENTAL_HISTORY
- 컬럼
  - HISTORY_ID	
  - CAR_ID
  - START_DATE
  - END_DATE

<br>

문제
- CAR_RENTAL_COMPANY_RENTAL_HISTORY 테이블에서 평균 대여 기간이 7일 이상인 자동차들의 자동차 ID와 평균 대여 기간(컬럼명: AVERAGE_DURATION) 리스트를 출력하는 SQL문을 작성해주세요. 평균 대여 기간은 소수점 두번째 자리에서 반올림하고, 결과는 평균 대여 기간을 기준으로 내림차순 정렬해주시고, 평균 대여 기간이 같으면 자동차 ID를 기준으로 내림차순 정렬해주세요.

<br>

풀이
- CAR_ID를 기준으로 그룹화 후 종료 기간에서 시작 기간의 차이 값을 구함 
- DATEDIFF(종료일, 시작일) 함수를 이용해 대여기간을 구할 수 있으나, 이 값에서 +1을 해주어야 올바른 기간 구할 수 있음
- ex. 시작일: 2022-09-27, 종료일: 2022-10-03 에서 종료일 - 시작일은 6이지만, 실제 대여기간은 7일임 
- 소수점 두번째 자리에서 반올림하라고 했으므로 ROUND( , 1)

<br>

```sql
SELECT CAR_ID, ROUND(AVG(DATEDIFF(END_DATE, START_DATE) + 1), 1) as AVERAGE_DURATION
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
GROUP BY CAR_ID
HAVING AVERAGE_DURATION >= 7 
ORDER BY AVERAGE_DURATION DESC, CAR_ID DESC
```